# （勉強中）ログ設計戦略

## ログ出力の目的
- 障害解析
- ユーザーの利用状況分析

## ログレベル

Log4j

| レベル | 概要           | 説明                                                                                                                                       | 出力先               | 運用時の対応           |
| :----- | :------------- | :----------------------------------------------------------------------------------------------------------------------------------------- | :------------------- | :--------------------- |
| FATAL  | 致命的なエラー | プログラムの異常終了を伴うようなもの。コンソール等に即時出力することを想定                                                                 | コンソール, ファイル | 即時対応が必要         |
| ERROR  | エラー         | 予期しないその他の実行時エラー。コンソール等に即時出力することを想定                                                                       | コンソール, ファイル | 営業時間内のみ対応     |
| WARN   | 警告           | 廃要素となったAPIの使用、APIの不適切な使用、エラーに近い事象など。実行時に生じた異常とは言い切れないが正常とも異なる何らかの予期しない問題 | コンソール, ファイル | 次回リリースまでに対応 |
| INFO   | 情報           | 実行時の何らかの注目すべき事象（開始や終了など）。メッセージ内容は簡潔に止めるべき                                                         | コンソール, ファイル | 対応不要               |
| DEBUG  | デバッグ情報   | システムの動作状況に関する詳細な情報                                                                                                       | ファイル             | 出力しない             |
| TRACE  | トレース情報   | デバッグ情報よりも、更に詳細な情報                                                                                                         | ファイル             | 出力しない             |

## 出力場所

| 出力場所       | 説明                                                                                                                                                                       |
| -------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 標準出力       | 主にバッチアプリケーションなど、コンソールから起動する場合で、途中経過を出力する場合などに使用する。                                                                       |
| 標準エラー出力 | 主にバッチアプリケーションなど、コンソールから起動する場合で、エラーが発生した場合などに使用する。標準出力に実行結果を出力する場合は、途中経過などに使用される場合もある。 |
| ファイル       | 主にコンソール以外で起動されるアプリケーションに使用する                                                                                                                   |
- 不特定多数のユーザーがアクセス可能な場所に出力しない

## 内容


## フォーマット
```
[LOG_LEVEL] [timestamp] [request_id] [function_name] message
```



## 

## ログのセキュリティ
各プロジェクトの個人情報保護指針に準拠すること。

- 例
    - 個人情報は出力せずにマスク処理をかける。
    - 識別性が必要な場合はハッシュ関数を使用する。


## ログと変更履歴


## 参考
- [今さら聞けないログの基本と設計指針](https://qiita.com/tadashiro_ninomiya/items/19c774898c68add6185e)
- [ログ設計指針](https://qiita.com/nanasess/items/350e59b29cceb2f122b3)
- [Webアプリケーションログ出力の基本](https://zenn.dev/sungvalley/articles/a73e53a56beb09)